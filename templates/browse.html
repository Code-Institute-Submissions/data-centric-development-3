{% extends 'base.html' %} {% block content %}

<div class="row">
    <div class="col s9 offset-s3">
        <h4>Browse our recipes!</h4>
    </div>
</div>
<!--Filter options-->
<div class="row">
    <ul class="collapsible" data-collapsible="accordion">
        <li>
            <div class="collapsible-header"><i class="material-icons">keyboard_arrow_down</i> Filter
            </div>
            <div class="collapsible-body">
                <form action="{{url_for('filter_recipes', username=username)}}" method="POST">
                    <div class="row">
                        <div class="col s12">
                            <!--Cuisine filter-->
                            <div class="col s4">
                                <div class="input-field col s12">
                                    <select id="cuisine" name="cuisine">
                                    <option value="all" selected>All</option>
                                    {% for c in cuisine %}
                                    {% if active_filters and active_filters.cuisine.lower() == c.name %}
                                    <option selected value="{{c.name}}">{{c.name.capitalize()}}</option>
                                    {% else %}
                                    <option value="{{c.name}}">{{c.name.capitalize()}}</option>
                                    {% endif %}
                                    {% endfor %}
                                </select>
                                    <label for="cuisine">Cuisine</label>
                                </div>
                            </div>
                            <!--Allergens filter-->
                            <div class="col s4">
                                <div class="input-field col s12">
                                    <select id="allergens" name="allergens">
                                    <option value="all" selected>All</option>
                                    {% for allergen in allergens %}
                                    {% if active_filters and active_filters.allergens.lower() == allergen.name%}
                                    <option selected value="{{allergen.name}}">{{allergen.name.capitalize()}}</option>
                                    {% else %}
                                    <option value="{{allergen.name}}">{{allergen.name.capitalize()}}</option>
                                    {% endif %}
                                    {% endfor %}
                                </select>
                                    <label for="allergens">Allergens</label>
                                </div>
                            </div>
                            <!--Time filter-->
                            <div class="col s4">
                                <div class="input-field col s12">
                                    <select id="time" name="time">
                                        <option value="0-180" selected>Any</option>
                                        {% for time in time_options %}
                                        {% if active_filters and active_filters.time == time %}
                                        <option selected value="{{time}}">{{time}}</option>
                                        {% else %}
                                        <option value="{{time}}">{{time}}</option>
                                        {% endif %}
                                        {% endfor %}
                                </select>
                                    <label for="time">Time (mins)</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <!--Servings filter-->
                        <div class="col s6">
                            <div class="input-field col s12">
                                <select id="servings" name="servings">
                                    <option value="0-20" selected>Any</option>
                                    {% for servings in servings_options%}
                                    {% if active_filters and active_filters.servings == servings %}
                                    <option selected value="{{servings}}">{{servings}}</option>
                                    {% else %}
                                    <option value="{{servings}}">{{servings}}</option>
                                    {% endif %}
                                    {% endfor %}
                                </select>
                                <label for="servings">Servings</label>
                            </div>
                        </div>
                        <!--Calories filter-->
                        <div class="col s6">
                            <div class="input-field col s12">
                                <select id="calories" name="calories">
                                    <option value="0-1000" selected>Any</option>
                                    {% for calories in calories_options%}
                                    {% if active_filters and active_filters.calories == calories %}
                                    <option selected value="{{calories}}">{{calories}}</option>
                                    {% else %}
                                    <option value="{{calories}}">{{calories}}</option>
                                    {% endif %}
                                    {% endfor %}
                                </select>
                                <label for="calories">Calories (per serving)</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s3">
                            <button class="waves-effect waves-light btn" type="submit" name="action">Filter
                                <i class="material-icons left">search</i>
                            </button>
                        </div>
                        <div class="col s3">
                            <a href="{{url_for('browse', username=username)}}" class="waves-effect waves-light btn red"><i class="material-icons left">delete</i>Remove</a>
                        </div>
                    </div>
                </form>
            </div>
        </li>
    </ul>
</div>
<div class="row">
    <div class="col s12">
        <div class="collection">

            {% if recipes.count() > 0 %} {% for recipe in recipes %}
            <a href="{{url_for('recipe_details', username=username, source='browse', recipe_id=recipe._id)}}" class="collection-item">
                {{recipe.title}}
                <i class="material-icons">thumb_up</i>{{recipe.upvotes}}
                <i class="material-icons">remove_red_eye</i>{{recipe.views}}
            </a> {% endfor %} {% else %}
            <div class="collection-item">Oh no! There's no recipes in the book!
                <a href="{{url_for('add_recipe', username=username.lower())}}">Be the first to add a recipe here!</a></div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}
